/**
 * 
 */
package paragraphing;

import java.util.ArrayList;

/**
 * @author XYZ
 *
 */
public class Paragrapher implements ParagrapherI {
	DestinationI destination ;
	int width = 20;
	private ArrayList<String> lines = new ArrayList<String>() ;

	public Paragrapher(DestinationI dest) {
		destination = dest ;
	}

	/** 
	 * @see paragraphing.ParagrapherI#setWidth(int)
	 */
	@Override
	public void setWidth(int width) {
		// TODO Auto-generated method stub
		this.width = width;
	}

	/**
	 * @see paragraphing.ParagrapherI#addWord(java.lang.String[])
	 */
	@Override
	public void addWord(String[] parts) {
		// TODO Auto-generated method stub
		if (lines.isEmpty()) {
			lines.add("<p>");
		}
		String str = "";
		for( String part :  parts ) { 
			if ((str + " " + part).length() <= this.width) {
				if (str.isEmpty()) {
					str = str + part;
				}
				else {
					str = str + " " + part;
				}
			} else {
				int allowedLength = this.width - str.length();
				String subString1 = part.substring(0, allowedLength - 1);
				String subString2 = part.substring(allowedLength - 1);
				lines.add("<line>" + str + subString1 + "-" + "</line>");
				str = subString2;
			}
		}
		lines.add("<line>" + str + "</line>");

	}

	/**
	 * @see paragraphing.ParagrapherI#addWord(java.lang.String)
	 */
	@Override
	public void addWord(String word) {
		// TODO Auto-generated method stub
	}

	/* (non-Javadoc)
	 * @see paragraphing.ParagrapherI#ship()
	 */
	@Override
	public void ship() {
		// TODO Auto-generated method stub
		if (!lines.isEmpty()) {
			lines.add("</p>");
			String[] linesString = new String[ lines.size() ] ;
			int i = 0 ;
			for( String line : lines ) linesString[i++] = line ;
			destination.addLines(linesString);
		}
	}

}
